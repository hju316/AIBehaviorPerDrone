    alt_km = drone(i).pos(3); % z-axis as altitude in km
    rho = atmosphere_density(alt_km); 
    speed = norm(drone(i).vel);
    Rn = 0.1; % Nose radius in meters (e.g., 10 cm)
    q = reentry_heat_flux(speed, rho, Rn); % W/mÂ²

    drone(i).heat_flux = q; % store it for analysis

    % Optional: thermal alert
    if q > 1e6  % above 1 MW/mÂ² is critical
        disp(['ğŸ”¥ Thermal warning on drone ' num2str(i) ' at t=' num2str(t*dt) ...
              's | q = ' num2str(q/1e6, '%.2f') ' MW/mÂ²']);
    end
